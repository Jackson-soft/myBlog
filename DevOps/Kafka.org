* Kafka 的集群搭建
** 依赖
#+begin_src shell
sudo apt install -y default-jdk
#+end_src

下载二进制文件
#+begin_src shell
wget https://mirror.bit.edu.cn/apache/kafka/2.6.0/kafka_2.13-2.6.0.tgz
#+end_src

#+begin_src shell
tar xzf kafka_2.13-2.6.0.tgz

sudo mv kafka_2.13-2.6.0 /opt/kafka
#+end_src
** zookeeper
#+begin_src shell
sudo vim /etc/systemd/system/zookeeper.service
#+end_src

#+begin_src text
[Unit]
Description=Apache Zookeeper server
Documentation=http://zookeeper.apache.org
Requires=network.target remote-fs.target
After=network.target remote-fs.target

[Service]
Type=simple
ExecStart=/opt/kafka/bin/zookeeper-server-start.sh /opt/kafka/config/zookeeper.properties
ExecStop=/opt/kafka/bin/zookeeper-server-stop.sh
Restart=on-abnormal

[Install]
WantedBy=multi-user.target
#+end_src
** kafka
*** 服务
#+begin_src shell
sudo vim /etc/systemd/system/kafka.service
#+end_src

#+begin_src text
[Unit]
Description=Apache Kafka Server
Documentation=http://kafka.apache.org/documentation.html
Requires=zookeeper.service

[Service]
Type=simple
Environment="JAVA_HOME=/usr/lib/jvm/default-java"
ExecStart=/opt/kafka/bin/kafka-server-start.sh /opt/kafka/config/server.properties
ExecStop=/opt/kafka/bin/kafka-server-stop.sh

[Install]
WantedBy=multi-user.target
#+end_src

#+begin_src shell
sudo systemctl daemon-reload
#+end_src

*** 配置
#+begin_src conf
broker.id=0
listeners=PLAINTEXT://:9092
zookeeper.connect=140.179.30.168:2181,140.179.30.63:2181,140.179.32.156:2181
#+end_src
